<!DOCTYPE html>

<html>

  <head>
    <meta charset="UTF-8">

  </head>

  <body scroll="no">

    <div style="position: absolute; left:0; top: 0;"><canvas width=400 height=400 id="base" style="position: absolute; left:0; top: 0; z-index: -1"></div>

  <!--   <div id = "controller" style="width: 100px; height: 100px; border: 2px solid black; position: absolute; left: 0; top: 0; z-index: 2"> -->

    <script src = "../helpers/clamp.js"></script>
    <script src = "../libraries/vector3d.js"></script>
    <script src = "../systems/graphics/dynamic-lighting/normalmap-engine.js"></script>

    <script>

      var controller = document.getElementById('controller');

      var canvas = document.getElementById('base');
      canvas.width = 400;
      canvas.height = 400;
      var ctx = canvas.getContext('2d');

      var baseImage = new Image(400,400);
      baseImage.onload = function(){
        ctx.drawImage(baseImage, 0, 0, 400, 400,
          0, 0 ,400, 400);
      };
      baseImage.src = '../assets/heronight.png';

      var normalmapImg = new Image(400,400);

      normalmapImg.onload = function(){
        var info = getNormalsFromImg(normalmapImg);
        var normals = info[0];
        var depth = info[1];

        var lightColor = new Vec3D({
          x: 255,
          y: 240,
          z: 200
        })

        window.addEventListener('mousemove', function(e){
          ctx.drawImage(baseImage,0,0);
          var lightPosition = new Vec3D({
            // transpose so 0 in in center, not upper-left corner
            x: e.clientX,
            y: e.clientY,
            z: 300
          });
          normalMap(canvas, ctx, normals, depth, lightPosition, lightColor);
        });
      };

      normalmapImg.src = '../assets/normaldepthmap.png';
    </script>


  </body>

</html>