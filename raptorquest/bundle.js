var App=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=54)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.owner=e.owner,this.name=e.name}return o(t,[{key:"getGame",value:function(){return this.owner.scene.game}},{key:"init",value:function(){}},{key:"update",value:function(){}}]),t}();t.exports=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(2),u=[0,0],l=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="camera",u=t.offset||u,n.cameraFollow=null,n.parallaxLayers=[],n}return i(e,t),s(e,[{key:"init",value:function(){this.cameraFollow=this.owner.scene.getControlsByName("camera-follow")[0]}},{key:"update",value:function(){if(this.cameraFollow&&this.cameraFollow.shouldFollow){var t=[];t[0]=Math.min(-this.cameraFollow.owner.controls.transform.position[0]+this.cameraFollow.margin[0],-32),t[1]=Math.min(-this.cameraFollow.owner.controls.transform.position[1]+this.cameraFollow.margin[1],-32),e.setOffset.apply(e,t),this.cameraFollow.shouldFollow=!1}}},{key:"reset",value:function(){c.setTransform(1,0,0,1,0,0),u[0]=0,u[1]=0}}],[{key:"reset",value:function(){e.setOffset(0,0)}},{key:"setOffset",value:function(t,e){u[0]=Math.round(t),u[1]=Math.round(e),c.setTransform(1,0,0,1,-u[0],-u[1])}},{key:"getOffset",value:function(){return u}},{key:"getViewportPosition",value:function(){return[-u[0],-u[1]]}},{key:"setViewportPosition",value:function(t,n){e.setOffset(-t,-n)}},{key:"getPixelWidth",value:function(){return 320}},{key:"getPixelHeight",value:function(){return 240}}]),e}(a);l.prototype.reset=l.reset,l.prototype.getOffset=l.getOffset,l.prototype.setOffset=l.setOffset,l.prototype.getViewportPosition=l.getViewportPosition,l.prototype.setViewportPosition=l.setViewportPosition,t.exports=l},function(t,e,n){"use strict";var r=n(59),o=r.canvasID,i=document.getElementById(o),s=i.getContext("2d");s.textStyle="white",s.webkitImageSmoothingEnabled=!1,s.msImageSmoothingEnabled=!1,s.imageSmoothingEnabled=!1,t.exports=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),Object.assign(this,e)}return o(t,[{key:"enter",value:function(){}},{key:"exit",value:function(){}},{key:"message",value:function(t){}},{key:"update",value:function(){}}]),t}();t.exports=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<t.length;n++)t[n](e)}var i,s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(){if(r(this,t),i)return i;this.handlers={},this.runKeyDownHandlers=this.runKeyDownHandlers.bind(this),this.runKeyUpHandlers=this.runKeyUpHandlers.bind(this),i=this}return s(t,[{key:"turnOn",value:function(){document.addEventListener("keydown",this.runKeyDownHandlers),document.addEventListener("keyup",this.runKeyUpHandlers)}},{key:"turnOff",value:function(){document.removeEventListener("keydown",this.runKeyDownHandlers),document.removeEventListener("keyup",this.runKeyUpHandlers)}},{key:"addKeyDownListener",value:function(t,e){this.handlers[t]||(this.handlers[t]={downHandlers:[],downHandlerIndices:{},upHandlers:[],upHandlerIndices:{}}),this.handlers[t].downHandlers.push(e),this.handlers[t].downHandlerIndices[e]=this.handlers[t].downHandlers.length-1}},{key:"removeKeyDownListener",value:function(t,e){this.handlers[t].downHandlers[this.handlers[t].downHandlerIndices[e]]=this.handlers[t].downHandlers[this.handlers[t].downHandlers.length-1],this.handlers[t].downHandlers.splice(this.handlers[t].downHandlers.length-1,1),delete this.handlers[t].downHandlerIndices[e]}},{key:"addKeyUpListener",value:function(t,e){this.handlers[t]||(this.handlers[t]={downHandlers:[],downHandlerIndices:{},upHandlers:[],upHandlerIndices:{}}),this.handlers[t].upHandlers.push(e),this.handlers[t].upHandlerIndices[e]=this.handlers[t].upHandlers.length-1}},{key:"removeKeyUpListener",value:function(t,e){this.handlers[t].upHandlers[this.handlers[t].upHandlerIndices[e]]=this.handlers[t].upHandlers[this.handlers[t].upHandlers.length-1],this.handlers[t].upHandlers.splice(this.handlers[t].upHandlers.length-1,1),delete this.handlers[t].upHandlerIndices[e]}},{key:"runKeyDownHandlers",value:function(t){var e=this.handlers[t.keyCode];e&&!e.down&&(t.preventDefault(),e.down=!0,o(e.downHandlers,t))}},{key:"runKeyUpHandlers",value:function(t){var e=this.handlers[t.keyCode];e&&(t.preventDefault(),e.down=!1,o(e.upHandlers,t))}}]),t}(),c=new a;c.turnOn(),t.exports=c},function(t,e,n){"use strict";function r(){}var o=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=n(26),s=Math.sin,a=Math.cos,c=new r,u=new i;(new i).push(0);var l=function(t){return u.push(t),c};Object.defineProperty(r.prototype,"$",{get:function(){return u.pop()}}),r.prototype.plus=function(t){return Array.isArray(t)?this.plusVector(t):this.plusScalar(t)},r.prototype.plusScalar=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]+t,e[1]+t]},3:function(){return[e[0]+t,e[1]+t,e[2]+t]},4:function(){return[e[0]+t,e[1]+t,e[2]+t,e[3]+t]}};return u.push(r[n]()),this},r.prototype.plusVector=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]+t[0],e[1]+t[1]]},3:function(){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},4:function(){return[e[0]+t[0],e[1]+t[1],e[2]+t[2],e[3]+t[3]]}};return u.push(r[n]()),this},r.prototype.minusVector=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]-t[0],e[1]-t[1]]},3:function(){return[e[0]-t[0],e[1]-t[1],e[2]-t[2]]},4:function(){return[e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3]]}};return u.push(r[n]()),this},r.prototype.timesScalar=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]*t,e[1]*t]},3:function(){return[e[0]*t,e[1]*t,e[2]*t]},4:function(){return[e[0]*t,e[1]*t,e[2]*t,e[3]*t]}};return u.push(r[n]()),this},r.prototype.timesVector=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]*t[0],e[1]*t[1]]},3:function(){return[e[0]*t[0],e[1]*t[1],e[2]*t[2]]},4:function(){return[e[0]*t[0],e[1]*t[1],e[2]*t[2],e[3]*t[3]]}}[t.length];return u.push(r[n]()),this},r.prototype.timesMatrix=function(t){var e=u.pop(),n=e.length,r={3:function(){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2],t[3]*e[0]+t[4]*e[1]+t[5]*e[2],t[6]*e[0]+t[7]*e[1]+t[8]*e[2]]},4:function(){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3]]},16:function(){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8]+t[3]*e[12],t[0]*e[1]+t[1]*e[5]+t[2]*e[9]+t[3]*e[13],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]+t[3]*e[14],t[0]*e[3]+t[1]*e[7]+t[2]*e[11]+t[3]*e[15],t[4]*e[0]+t[5]*e[4]+t[6]*e[8]+t[7]*e[12],t[4]*e[1]+t[5]*e[5]+t[6]*e[9]+t[7]*e[13],t[4]*e[2]+t[5]*e[6]+t[6]*e[10]+t[7]*e[14],t[4]*e[3]+t[5]*e[7]+t[6]*e[11]+t[7]*e[15],t[8]*e[0]+t[9]*e[4]+t[10]*e[8]+t[11]*e[12],t[8]*e[1]+t[9]*e[5]+t[10]*e[9]+t[11]*e[13],t[8]*e[2]+t[9]*e[6]+t[10]*e[10]+t[11]*e[14],t[8]*e[3]+t[9]*e[7]+t[10]*e[11]+t[11]*e[15],t[12]*e[0]+t[13]*e[4]+t[14]*e[8]+t[15]*e[12],t[12]*e[1]+t[13]*e[5]+t[14]*e[9]+t[15]*e[13],t[12]*e[2]+t[13]*e[6]+t[14]*e[10]+t[15]*e[14],t[12]*e[3]+t[13]*e[7]+t[14]*e[11]+t[15]*e[15]]}};return u.push(r[n]()),this},r.prototype.times=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return 1===e.length?this.timesScalar(e):16===e.length?this.timesMatrix.apply(this,e):this.timesVector.apply(this,e)},r.prototype.divideByScalar=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]/t,e[1]/t]},3:function(){return[e[0]/t,e[1]/t,e[2]/t]},4:function(){return[e[0]/t,e[1]/t,e[2]/t,e[3]/t]}};return u.push(r[n]()),this},r.prototype.divideByVector=function(t){var e=u.pop(),n=e.length,r={2:function(){return[e[0]/t[0],e[1]/t[1]]},3:function(){return[e[0]/t[0],e[1]/t[1],e[2]/t[2]]},4:function(){return[e[0]/t[0],e[1]/t[1],e[2]/t[2],e[3]/t[3]]}};return u.push(r[n]()),this},r.prototype.divideBy=function(t){return Array.isArray(t)?this.divideByVector(t):this.divideByScalar(t)},r.prototype.dot=function(t){var e=u.pop(),n=e.length,r={2:function(){return e[0]*t[0]+e[1]*t[1]},3:function(){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},4:function(){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}};return u.push(r[n]()),this},r.prototype.mix=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return u.push(this.timesScalar(1-e).plusVector(l(t).timesScalar(e).$).$),this},r.prototype.squaredLength=function(){return u.push(this.dot(u.peek()).$),this},r.prototype.length=function(){return u.push(Math.sqrt(this.squaredLength().$)),this},r.prototype.distanceTo=function(t){var e=u.pop(),n=l(t).minusVector(e).$;return u.push(l(n).length().$),this},r.prototype.squaredDistanceTo=function(t){var e=u.pop(),n=l(t).minusVector(e).$;return u.push(l(n).squaredLength().$),this},r.prototype.nearest=function(t,e){var n=u.pop(),r=l(n).squaredDistanceTo(t).$,o=l(n).squaredDistanceTo(e).$;return u.push(r<o?t:e),this},r.prototype.isRightOf=function(t){var e=u.pop();return u.push((t[2]-t[0])*(e[1]-t[1])>(t[3]-t[1])*(e[0]-t[0])),this},r.prototype.sideOfLine=function(t){var e=u.pop();return u.push(Math.sign((t[2]-t[0])*(e[1]-t[1])-(t[3]-t[1])*(e[0]-t[0]))),this},r.prototype.unit=function(){var t=u.peek();return 0!==t[0]||0!==t[1]||2!==t.length&&0!==t[2]?u.push(this.divideByScalar(l(u.peek()).length().$).$):(u.pop(),u.push([0,0,0].slice(-t.length))),this},r.prototype.turnLeft=function(){var t=u.pop();return u.push([-t[1],t[0]]),this},r.prototype.turnRight=function(){var t=u.pop();return u.push([t[1],-t[0]]),this},r.prototype.leftNormal=function(){var t=u.pop();return u.push(l(t).unit().turnLeft().$),this},r.prototype.rightNormal=function(){var t=u.pop();return u.push(l(t).unit().turnRight().$),this},r.prototype.rotate2d=function(t){var e=u.pop();e.length;return e[0]=e[0]*a(t)-e[1]*s(t),e[1]=e[0]*s(t)+e[1]*a(t),u.push(e),this},r.prototype.angle2d=function(){var t=u.pop();t.length;return u.push(Math.atan2(t[1],t[0])),this},r.prototype.directionTo=function(t){var e=u.pop();e.length;return u.push(this.minusVector(e).unit().$),this},r.prototype.projectedLength=function(t){return u.push(Math.sqrt(Math.abs(this.dot(t).$))),this},r.prototype.scalarProjection=function(t){var e=u.pop(),n=l(t).length().$;return u.push(0===n?[0,0,0,0].slice(-e.length):l(t).unit().times(l(e).dot(t).$/l(t).squaredLength().$).$),this},r.prototype.transpose=function(){var t=u.pop();t.length;return u.push([t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]),this},r.prototype.rotate=function(t){var e=o(t,3),n=e[0],r=e[1],i=e[2],c=u.pop();if(2===c.length)return u.push(this.rotate2d(n).$),this;var h=[1,0,0,0,0,a(n),-s(n),0,0,s(n),a(n),0,0,0,0,1],p=[a(r),0,s(r),0,0,1,0,0,-s(r),0,a(r),0,0,0,0,1],f=[a(i),-s(i),0,0,s(i),a(i),0,0,0,0,1,0,0,0,0,1];return u.push(l(c).timesMatrix(h).timesMatrix(p).timesMatrix(f).$),this},r.prototype.cross=function(t){var e=u.pop();e.length;return u.push([e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]),this},r.prototype.coordPairToVector=function(){var t=u.pop();return u.push(l([t[2],t[3]]).minusVector([t[0],t[1]]).$),this},r.prototype.angleTo=function(t){var e=u.pop();return u.push(Math.acos(l(e).dot(t).$)),this},r.prototype.rotateToPlane=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,1,0],n=u.pop(),r=[];if(0!=t[0]||0!=t[1]||0!=t[2])var i=Math.acos(l(e).dot(t).$),c=l(e).cross(t).unit().$,h=a(i),p=1-h,f=s(i),d=o(c,3),y=d[0],g=d[1],m=d[2],v=p*y,b=p*g,w=p*m,k=v*g,S=k,O=v*y,j=b*m,M=j,x=b*g,_=v*m,P=_,T=w*m,C=y*f,E=g*f,L=m*f,r=[O+h,S-L,P+E,k+L,x+h,M-C,_+E,j+C,T+h];else r=[1,0,0,0,1,0,0,0,1];return u.push(l(n).timesMatrix(r).$),this},r.prototype.toHexString=function(){var t=u.pop(),e=("00"+t[0].toString(16)).slice(-2),n=("00"+t[1].toString(16)).slice(-2),r=("00"+t[2].toString(16)).slice(-2);return u.push(e+n+r),this},r.prototype.fromHexString=function(){var t=u.pop(),e=[parseInt(t.slice(0,1),16),parseInt(t.slice(2,3),16),parseInt(t.slice(4,5),16)];return u.push(e),this},r.prototype.hexColor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=u.pop();-1===t&&(e=l(e).plus(1).divideBy(2).$),e=l(e).times(256).$;var n=("00"+e[0].toString(16)).slice(-2),r=("00"+e[1].toString(16)).slice(-2),o=("00"+e[2].toString(16)).slice(-2);return u.push(n+r+o),this},r.prototype.findParametricEquation=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=u.peek();return t.slope=(e[3]-e[1])/(e[2]-e[0]),t.yIntercept=e[1]-slope*e[0],this},r.prototype.sqDistanceToLineSegment=function(t){var e=u.pop(),n=l([t[0],t[1]]).distanceTo([t[2],t[3]]).$;if(0==n)return u.push(l(e).distanceTo([t[0],t[1]]).$),this;var r=((e[0]-t[0])*(t[2]-t[0])+(e[0]-t[1])*(t[3]-t[1]))/n;return u.push(r),this},r.prototype.distanceToLineSegment=function(t){var e=u.pop(),n=l(e).sqDistanceToLineSegment(t).$;return 0==n?u.push(0):u.push(Math.sqrt(n)),this},r.prototype.inverse=function(){var t=r.IDENTITY_MATRIX,e=u.pop();e.length;t[0]=e[5]*e[10]*e[15]-e[5]*e[14]*e[11]-e[6]*e[9]*e[15]+e[6]*e[13]*e[11]+e[7]*e[9]*e[14]-e[7]*e[13]*e[10],t[1]=-e[1]*e[10]*e[15]+e[1]*e[14]*e[11]+e[2]*e[9]*e[15]-e[2]*e[13]*e[11]-e[3]*e[9]*e[14]+e[3]*e[13]*e[10],t[2]=e[1]*e[6]*e[15]-e[1]*e[14]*e[7]-e[2]*e[5]*e[15]+e[2]*e[13]*e[7]+e[3]*e[5]*e[14]-e[3]*e[13]*e[6],t[3]=-e[1]*e[6]*e[11]+e[1]*e[10]*e[7]+e[2]*e[5]*e[11]-e[2]*e[9]*e[7]-e[3]*e[5]*e[10]+e[3]*e[9]*e[6],t[4]=-e[4]*e[10]*e[15]+e[4]*e[14]*e[11]+e[6]*e[8]*e[15]-e[6]*e[12]*e[11]-e[7]*e[8]*e[14]+e[7]*e[12]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[14]*e[11]-e[2]*e[8]*e[15]+e[2]*e[12]*e[11]+e[3]*e[8]*e[14]-e[3]*e[12]*e[10],t[6]=-e[0]*e[6]*e[15]+e[0]*e[14]*e[7]+e[2]*e[4]*e[15]-e[2]*e[12]*e[7]-e[3]*e[4]*e[14]+e[3]*e[12]*e[6],t[7]=e[0]*e[6]*e[11]-e[0]*e[10]*e[7]-e[2]*e[4]*e[11]+e[2]*e[8]*e[7]+e[3]*e[4]*e[10]-e[3]*e[8]*e[6],t[8]=e[4]*e[9]*e[15]-e[4]*e[13]*e[11]-e[5]*e[8]*e[15]+e[5]*e[12]*e[11]+e[7]*e[8]*e[13]-e[7]*e[12]*e[9],t[9]=-e[0]*e[9]*e[15]+e[0]*e[13]*e[11]+e[1]*e[8]*e[15]-e[1]*e[12]*e[11]-e[3]*e[8]*e[13]+e[3]*e[12]*e[9],t[10]=e[0]*e[5]*e[15]-e[0]*e[13]*e[7]-e[1]*e[4]*e[15]+e[1]*e[12]*e[7]+e[3]*e[4]*e[13]-e[3]*e[12]*e[5],t[11]=-e[0]*e[5]*e[11]+e[0]*e[9]*e[7]+e[1]*e[4]*e[11]-e[1]*e[8]*e[7]-e[3]*e[4]*e[9]+e[3]*e[8]*e[5],t[12]=-e[4]*e[9]*e[14]+e[4]*e[13]*e[10]+e[5]*e[8]*e[14]-e[5]*e[12]*e[10]-e[6]*e[8]*e[13]+e[6]*e[12]*e[9],t[13]=e[0]*e[9]*e[14]-e[0]*e[13]*e[10]-e[1]*e[8]*e[14]+e[1]*e[12]*e[10]+e[2]*e[8]*e[13]-e[2]*e[12]*e[9],t[14]=-e[0]*e[5]*e[14]+e[0]*e[13]*e[6]+e[1]*e[4]*e[14]-e[1]*e[12]*e[6]-e[2]*e[4]*e[13]+e[2]*e[12]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[9]*e[6]-e[1]*e[4]*e[10]+e[1]*e[8]*e[6]+e[2]*e[4]*e[9]-e[2]*e[8]*e[5];for(var n=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12]||1,o=0;o<16;o++)t[o]/=n;return u.push(t),this},t.exports=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(3),c=function(t){function e(){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),s(e,[{key:"onMouseUp",value:function(){}},{key:"onMouseDown",value:function(){}},{key:"onMouseMove",value:function(){}},{key:"onKeyDown",value:function(){}},{key:"onKeyUp",value:function(){}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=(n(3),1),s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t),this.name=e.name||"StateMachine"+i++,this.states=e.states||{},this.currentState=this.states[e.initialState],this.currentStateName=e.initialState,this.controls={};var n,o;e.controls=e.controls||{};for(var s in e.controls)n=e.controls[s],o=n.args||{},o.owner=this,this.controls[s]=new n.kind(o)}return o(t,[{key:"update",value:function(){this.currentState.update.call(this)}},{key:"message",value:function(t,e){this.currentState.message.call(this,t,e)}},{key:"changeState",value:function(t,e){this.currentStateName!=t&&(this.currentState.exit.call(this,e),this.currentState=this.states[t],this.currentStateName=t,this.currentState.enter.call(this,e))}}]),t}();t.exports=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o,i,s,a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(26),u=(n(7),n(12),n(2),n(1)),l=320,h=function(){function t(e){if(r(this,t),null!=o)return console.warn("Trying to instantiate more than one Game, returning original instance"),o;this.debugManager=new(n(43))({game:this}),this.debugMode=!1,this.scenes=e.scenes||{},this.sceneStack=new c,this.currentTime=0,this.dt=0,this.running=!1;for(var i in this.scenes)this.scenes[i].setGame(this),this.scenes[i].init();this.tick=this.tick.bind(this),o=this}return a(t,[{key:"push",value:function(t){this.currentScene&&this.currentScene.exit(this,this.currentScene),this.sceneStack.push(this.scenes[t]),this.updateCurrent()}},{key:"pop",value:function(t){this.currentScene.exit(this,this.currentScene),this.sceneStack.pop(),this.updateCurrent()}},{key:"replaceTop",value:function(t){this.currentScene.exit(this,this.currentScene),this.sceneStack.pop(),this.sceneStack.push(this.scenes[t]),this.updateCurrent()}},{key:"updateCurrent",value:function(){this.currentScene=this.sceneStack.peek(),u.reset(),this.currentScene.enter(this,this.currentScene)}},{key:"start",value:function(){this.running||(s=null,i=requestAnimationFrame(this.tick),this.running=!0)}},{key:"stop",value:function(){this.running&&(cancelAnimationFrame(i),this.running=!1)}},{key:"tick",value:function(t){i=requestAnimationFrame(this.tick),this.currentTime=t,s||(s=t),this.dt=t-s,this.update(),s=t}},{key:"advanceFrame",value:function(){this.currentTime=s=Date.now(),this.dt=17,this.update()}},{key:"update",value:function(){this.currentScene.update()}}],[{key:"getScreenWidth",value:function(){return l}},{key:"getScreenHeight",value:function(){return 240}},{key:"setScreenWidth",value:function(t){l=t}},{key:"setScreenHeight",value:function(t){l=t}}]),t}();t.exports=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(7),c=n(25),u=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.scene=t.scene,n.tag=t.tag||"",n.scene.registerObject(n),n.active=t.active||!1,n}return i(e,t),s(e,[{key:"getControlsByName",value:function(t){return c(this.controls).filter(function(e){return e.name==t})}},{key:"getControlsByTag",value:function(t){return c(this.controls).filter(function(e){return e.tag==t})}},{key:"getGame",value:function(){return this.scene.game}}],[{key:"reset",value:function(){}}]),e}(a);t.exports=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(5),u=function(t){function e(t){r(this,e),t.name="mapCollider";var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.tags=t.tags,n.checkPoint=t.checkPoint,n.onHit=t.onHit||function(){return!1},n.onNoCollision=t.onNoCollision||function(){},n.enabled=t.enabled||!0,n}return i(e,t),s(e,[{key:"getWorldCheckPoint",value:function(){return c(this.checkPoint).plusVector(this.owner.controls.transform.position).$}},{key:"getNextWorldCheckPoint",value:function(){return c(this.checkPoint).plusVector(this.owner.controls.velocity.previewNewPosition()).$}}]),e}(a);t.exports=u},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),u=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="sprite",n.tag=t.tag,n.animating=void 0==t.animating||t.animating,n.spritesheetName=t.spritesheetName,n.spritesheetData=t.spritesheetData,n.animations=t.animations,n.layer=t.layer,n.offset=t.offset||[0,0],n.currentAnimation,n.currentAnimationName,n.currentFrameNum=0,n.elapsedTime=0,n.looping=!0,n.finished=!1,n.enabled=!0,n.onFinished=function(){},n.setAnimation.apply(n,r(t.initialAnimation)),n}return s(e,t),a(e,[{key:"update",value:function(){this.animating&&this.advanceFrame()}},{key:"advanceFrame",value:function(){this.elapsedTime+=this.getGame().dt,this.looping?this.elapsedTime=this.elapsedTime%(200*this.numFrames):this.finished||this.elapsedTime>=200*this.numFrames&&(this.onFinished(),this.finished=!0),this.currentFrameNum=Math.floor(this.elapsedTime/200),this.currentFrame=this.currentAnimation[this.currentFrameNum]}},{key:"setFrame",value:function(t){this.currentFrameNum=Math.max(Math.min(t,this.currentAnimation.length-1),0),this.currentFrame=this.currentAnimation[this.currentFrameNum]}},{key:"setAnimation",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};this.looping=e,this.finished=!1,this.onFinished=n,this.currentAnimationName=t,this.currentAnimation=this.animations[t],this.currentFrameNum=0,this.currentFrame=this.currentAnimation[this.currentFrameNum],this.numFrames=this.currentAnimation.length,this.elapsedTime=0}}]),e}(c);t.exports=u},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(14),a=n(31),c=(n(2),n(25)),u=1,l=function(){function t(e){o(this,t),this.name=e.name||"Scene"+u++,this.game=null,this.objectIndices={},this.objects=[],this.initialized=!1,this.assetManager=new s(e.assets),this.tileMap=new a({mapSrc:e.tileMapSrc,key:e.tileMapKey}),this.enter=e.enter||this.enter,this.exit=e.exit||this.exit,this.initialObjectList=e.objects||[],this.screenX=0,this.screenY=0}return i(t,[{key:"resetObjects",value:function(){this.objectIndices={},this.objects=[];for(var t=0;t<this.initialObjectList.length;t++)this.initialObjectList[t].reset();for(var e=0;e<this.initialObjectList.length;e++)new this.initialObjectList[e]({scene:this});this.init()}},{key:"setGame",value:function(t){this.game=t}},{key:"enter",value:function(){var t=this;return this.game.stop(),this.resetObjects(),new Promise(function(e,n){t.assetManager.load().then(function(){t.tileMap.init().then(function(){t.game.start(),e()})})})}},{key:"exit",value:function(){}},{key:"init",value:function(){for(var t=this.getAllControls(),e=0;e<t.length;e++)t[e].init()}},{key:"getAllControls",value:function(){for(var t=[],e=0;e<this.objects.length;e++)t.push.apply(t,r(c(this.objects[e].controls)));return t}},{key:"getControlsByName",value:function(t){for(var e=[],n=0;n<this.objects.length;n++)e.push.apply(e,r(this.objects[n].getControlsByName(t)));return e}},{key:"getControlsByTag",value:function(t){for(var e=[],n=0;n<this.objects.length;n++)e.push.apply(e,r(this.objects[n].getControlsByTag(t)));return e}},{key:"getObjectByName",value:function(t){return this.objects[this.objectIndices[t]]}},{key:"registerObject",value:function(t){this.objects.push(t),this.objectIndices[t.name]=this.objects.length-1}},{key:"update",value:function(){for(var t=0;t<this.objects.length;t++)this.objects[t].update()}}]),t}();t.exports=l},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),u=n(5),l=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="transform",n.position=t.position||[0,0],n.size=t.size||[0,0],n.prevPosition=[].concat(r(n.position)),n}return s(e,t),a(e,[{key:"getBounds",value:function(){return[].concat(r(this.position),r(u(this.position).plusVector(this.size).$))}},{key:"getCenter",value:function(){return u(this.position).plusVector(u(this.size).timesScalar(.5).$).$}},{key:"moveTo",value:function(t,e){this._setPrevPosition(),this.position[0]=t,this.position[1]=e}},{key:"moveBy",value:function(t,e){this._setPrevPosition(),this.position[0]+=t,this.position[1]+=e}},{key:"moveUp",value:function(t){this._setPrevPosition(),this.position[1]-=t}},{key:"moveDown",value:function(t){this._setPrevPosition(),this.position[1]+=t}},{key:"moveLeft",value:function(t){this._setPrevPosition(),this.position[0]-=t}},{key:"moveRight",value:function(t){this._setPrevPosition(),this.position[0]+=t}},{key:"_setPrevPosition",value:function(){this.prevPosition[0]=this.position[0],this.prevPosition[1]=this.position[1]}},{key:"update",value:function(){this._setPrevPosition()}}]),e}(c);t.exports=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=/.*\.(jpg|png|gif)/,s=/.*\.(wav|mp3)/;window.AudioContext=window.AudioContext||window.webkitAudioContext;var a=new AudioContext,c=function(){function t(e){r(this,t),this.assets={},this.assetSrcs=e,this.currentlyPlayingTracks={},this.loadPercent=0}return o(t,[{key:"dump",value:function(){this.assets={}}},{key:"load",value:function(){var t=this,e=[];for(name in this.assetSrcs)e.push(this._assetLoadPromise(name,this.assetSrcs[name]));return new Promise(function(n,r){Promise.all(e).then(function(){t.loadPercent=0,n()})})}},{key:"onLoadProgress",value:function(t){}},{key:"loop",value:function(t){if(!this.assets[t])return void console.error("Asset "+t+" does not exist!");var e=a.createBufferSource();e.buffer=this.assets[t],e.connect(a.destination),e.loop=!0,e.start(0),this.currentlyPlayingTracks[t]=e}},{key:"stop",value:function(t){this.currentlyPlayingTracks[t]&&(this.currentlyPlayingTracks[t].stop(),delete this.currentlyPlayingTracks[t])}},{key:"play",value:function(t){if(!this.assets[t])return void console.error("Asset "+t+" does not exist!");var e=a.createBufferSource();e.buffer=this.assets[t],e.connect(a.destination),e.start(0)}},{key:"_assetLoadPromise",value:function(t,e){var n=this;return new Promise(function(r,o){e.match(i)?n._resolveImgLoad(t,e,r,o):e.match(s)&&n._resolveAudioLoad(t,e,r,o)})}},{key:"_incrementLoadPercent",value:function(){this.loadPercent=Math.ceil(this.loadPercent+1/Object.keys(this.assetSrcs).length*100),this.onLoadProgress(this.loadPercent)}},{key:"_resolveImgLoad",value:function(t,e,n,r){var o=this;if(this.assets[t])this._incrementLoadPercent(),n();else{var i=new Image;i.onload=function(){o._incrementLoadPercent(),o.assets[t]=i,n()},i.onerror=r,i.src=e}}},{key:"_resolveAudioLoad",value:function(t,e,n,r){var o=this;if(this.assets[t])this._incrementLoadPercent(),n();else{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){a.decodeAudioData(i.response,function(e){o._incrementLoadPercent(),o.assets[t]=e,n()})},i.send()}}}]),t}();t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="walk",n.acceleration=t.acceleration||1,n.topImpulse=t.topImpulse||3,n.impulse=0,n.direction=0,n}return i(e,t),s(e,[{key:"change",value:function(t){t!=this.direction&&(this.direction=t,this.owner.controls.animationStateMachine.setParameter("direction",t))}},{key:"update",value:function(t){if(0==this.direction){if(0==this.owner.controls.velocity.x)return;Math.abs(this.owner.controls.velocity.x)<1?this.owner.controls.velocity.x=0:this.owner.controls.velocity.x*=.7}else(this.direction>0&&this.owner.controls.velocity.x<this.topImpulse||this.direction<0&&this.owner.controls.velocity.x>-this.topImpulse)&&(this.owner.controls.velocity.x+=this.direction*this.acceleration)}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(30),c=(n(3),function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="animationStateMachine",n.tag=t.tag,n.sprite,n}return i(e,t),s(e,[{key:"init",value:function(){var t=this;this.sprite=this.owner.getControlsByName("sprite").find(function(e){return e.tag==t.tag})}}]),e}(a));t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=function(t){function e(){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),s(e,[{key:"update",value:function(){this.owner.controls.velocity.y+=this.getGame().dt/30*.6}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),u=n(5),l=function(t){function e(t){o(this,e),t.name="objectCollider";var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.tags=t.tags,n.hitbox=t.hitbox,n.checkPoints=t.checkPoints,n.onHit=t.onHit||function(t){},n.enabled=t.enabled||!0,n}return s(e,t),a(e,[{key:"getWorldHitbox",value:function(){return u(this.hitbox).plusVector([].concat(r(this.owner.controls.transform.position),r(this.owner.controls.transform.position))).$}}]),e}(c);t.exports=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(8),u=(n(55),n(1)),l=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.tag=t.tag,n.nextObjectPlacementTime=0,n.activeComponents=[],n.inactiveComponents=[],n.scrollingEngine=null,n.deltaPixels=0,n.waitTime=0,n.layer=t.layer||"foreground",n.objectFrequency=t.objectFrequency||.75,n.minInterval=t.minInterval||50,n.maxInterval=t.maxInterval||90,n.lastObjectRightEdge=0,n}return i(e,t),s(e,[{key:"init",value:function(){var t=this;this.lastObjectRightEdge=u.getOffset()[0]-c.getScreenWidth();var e=this.owner.scene.getControlsByName("objectpooler").filter(function(e){return e.tag==t.tag});this.inactiveComponents=e.filter(function(t){return"inactive"==t.owner.currentStateName}),this.activeComponents=e.filter(function(t){return"inactive"!=t.owner.currentStateName});for(var n=0;n<this.inactiveComponents.length;n++)this.inactiveComponents[n].setObjectPool(this);for(var r=0;r<this.activeComponents.length;r++)this.activeComponents[r].setObjectPool(this);this.scrollingEngine=this.owner.scene.getControlsByName("scrollingEngine").find(function(e){return e.layer==t.layer})}},{key:"returnToPool",value:function(t){this.activeComponents.splice(this.activeComponents.indexOf(t),1),this.inactiveComponents.push(t)}},{key:"update",value:function(){if(this.lastObjectRightEdge<c.getScreenWidth()-u.getOffset()[0]){if(Math.random()<this.objectFrequency){var t=Math.floor(Math.random()*(this.inactiveComponents.length-1)),e=this.inactiveComponents.splice(t,1)[0];e&&(this.activeComponents.push(e),e.activate(c.getScreenWidth()-u.getOffset()[0]-3),this.lastObjectRightEdge=e.owner.controls.transform.getBounds()[2])}else{var t=Math.ceil(Math.random()*(this.maxInterval-this.minInterval)+this.minInterval);this.lastObjectRightEdge=-u.getOffset()[0]+c.getScreenWidth()+t}}}}]),e}(a);t.exports=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(2),u=(n(1),0),l=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="spriteEngine",n.tag="renderer",n.components=[],n.enabled=!0,n.layer=t.layer||u++,n}return i(e,t),s(e,[{key:"init",value:function(){var t=this;this.components=this.owner.scene.getControlsByName("sprite").filter(function(e){return e.layer==t.layer})}},{key:"render",value:function(){for(var t,e,n,r=0;r<this.components.length;r++)if(this.components[r].enabled){n=this.components[r].spritesheetName,t=this.components[r].currentFrame;var e=this.components[r].spritesheetData.frames[t];c.drawImage(this.owner.scene.assetManager.assets[n],e.x,e.y,e.w,e.h,this.components[r].owner.controls.transform.position[0]+this.components[r].offset[0],this.components[r].owner.controls.transform.position[1]+this.components[r].offset[1],e.w,e.h)}}}]),e}(a);l.reset=function(){u=0},t.exports=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(5),u=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="velocity",n.x=0,n.y=0,n}return i(e,t),s(e,[{key:"applyVelocity",value:function(){this.owner.controls.transform.moveBy(this.x,this.y)}},{key:"previewNewPosition",value:function(){return c(this.owner.controls.transform.position).plusVector([this.x,this.y]).$}}]),e}(a);t.exports=u},function(t,e,n){"use strict";var r=n(6),o=(n(2),n(1),n(4)),i=new r({enter:function(){o.turnOn(),this.game.start(),this.buttons.start.innerHTML='<i class="fa fa-pause"></i>',this.disableAllButtonsExcept(this.buttons.start),cancelAnimationFrame(this.updateLoop),this.canvas.removeEventListener("mousedown",this.onMouseDown),this.canvas.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),this.game.debugMode=!1}});t.exports=i},function(t,e,n){"use strict";var r=n(6),o=(n(2),n(1)),i=(n(4),new r({enter:function(){this.disableAllButtonsExcept(this.buttons.scroll),this.canvas.style.cursor="all-scroll"},exit:function(){this.enableAllButtons(),this.canvas.style.cursor="default"},onMouseDown:function(t){this.mouseDown||(this.lastMouseX=t.layerX,this.lastMouseY=t.layerY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY,this.mouseDown=!0)},onMouseMove:function(t){this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY},onMouseUp:function(t){this.mouseDown=!1},onKeyUp:function(t){t.keyCode==this.keys.space&&this.changeState("selection")},update:function(){if(this.updateLoop=requestAnimationFrame(this.update.bind(this)),this.mouseDown&&(this.currentMouseX!=this.lastMouseX||this.currentMouseY!=this.lastMouseY)){var t=(this.currentMouseX-this.lastMouseX)/2,e=(this.currentMouseY-this.lastMouseY)/2,n=o.getOffset();n[0]+=t,n[1]+=e,o.setOffset(n[0],n[1]),this.render()}}}));t.exports=i},function(t,e,n){"use strict";function r(t,e,n,r,o,i,s,a){if(t===n&&e===r||o===s&&i===a)return null;var c=(a-i)*(n-t)-(s-o)*(r-e);if(0===c)return null;var u=((s-o)*(e-i)-(a-i)*(t-o))/c;return[t+u*(n-t),e+u*(r-e)]}function o(t,e,n,r,o,i,s,a){if(t===n&&e===r||o===s&&i===a)return null;var c=(a-i)*(n-t)-(s-o)*(r-e);if(0===c)return null;var u=((s-o)*(e-i)-(a-i)*(t-o))/c,l=((n-t)*(e-i)-(r-e)*(t-o))/c;return u<0||u>1||l<0||l>1?null:[t+u*(n-t),e+u*(r-e)]}t.exports={lines:r,lineSegments:o}},function(t,e,n){"use strict";function r(t){var e=[];for(var n in t)e.push(t[n]);return e}t.exports=r},function(t,e,n){"use strict";function r(){this.top=null}r.prototype.push=function(t){this.top={value:t,below:this.top}},r.prototype.pop=function(){var t=this.top;return this.top=this.top.below,t.value},r.prototype.replaceTop=function(t){var e={value:t,below:this.top.below};this.top=e},r.prototype.removeAt=function(t){for(var e=this.top,n=0;n<t-2;n++)e=e.below;e.below=e.below.below},r.prototype.removeWhere=function(t){for(var e=this.top;null!=e&&null!=e.below;)t(e.below.value)&&(e.below=e.below.below),e=e.below},r.prototype.peek=function(){return this.top.value},r.prototype.fill=function(t){for(var e=0;e<t.length;e++)this.push(t[e])},r.prototype.fillWithValues=function(t){for(var e=0;e<a.length;e++)this.pushValue(t[e])},r.prototype.toArr=function(){for(var t=[],e=this.top;null!=e;)t.push(e),e=e.below;return t},t.exports=r},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(9),a=(n(8),n(5)),c=function(t){function e(t){r(this,e);var i={name:"player",scene:t.scene,active:!0,states:{walking:n(28),flying:n(67),dying:n(65)},initialState:"flying",controls:{transform:{kind:n(13),args:{position:[100,200],size:[48,34]}},advance:{kind:n(15),args:{acceleration:2}},gravity:{kind:n(17)},flap:{kind:n(34)},tailManager:{kind:n(42)},tailSprite:{kind:n(11),args:{tag:"tail",animating:!1,spritesheetName:"tailSprites",spritesheetData:n(64),animations:{Rblend:["Rtail00","Rtail01","Rtail02","Rtail03","Rtail04","Rtail05","Rtail06","Rtail07","Rtail08"],Lblend:["Ltail00","Ltail01","Ltail02","Ltail03","Ltail04","Ltail05","Ltail06","Ltail07","Ltail08"]},initialAnimation:["Rblend",!0],layer:2}},animationStateMachine:{kind:n(16),args:{tag:"body",states:n(68),initialState:"initial",parameters:{direction:0}}},bodySprite:{kind:n(11),args:{tag:"body",spritesheetName:"bodySprites",spritesheetData:n(61),animations:{Lstand:["Lraptorstand"],Lwalk:["Lraptorwalk00","Lraptorwalk01"],Ljump:["Lraptorflap00"],Lfall:["Lraptorflap01"],Lhurt:["Lraptorhurt"],Rstand:["Rraptorstand"],Rwalk:["Rraptorwalk00","Rraptorwalk01"],Rjump:["Rraptorflap00"],Rfall:["Rraptorflap01"],Rhurt:["Rraptorhurt"]},initialAnimation:["Rstand",!0],layer:2}},flicker:{kind:n(35)},objectCollider:{kind:n(18),args:{hitbox:[20,10,44,20],onHit:function(t){this.owner.changeState("dying");var e=this.getWorldHitbox(),n=t.getWorldHitbox(),r=a([e[0],e[1]]).plusVector(a([this.hitbox[2],this.hitbox[3]]).minusVector([this.hitbox[0],this.hitbox[1]]).timesScalar(.5).$).$,o=a([n[0],n[1]]).plusVector(a([n[2],n[3]]).minusVector([n[0],n[1]]).timesScalar(.5).$).$,i=a(r).minusVector(o).unit().$;this.owner.controls.velocity.x+=10*i[0],this.owner.controls.velocity.y+=10*i[1]}}},feetMapCollider:{kind:n(10),args:{tags:["level01"],checkPoint:[28,28],onHit:function(t){return this.owner.changeState("walking"),this.owner.controls.flap.floorNormal=t.normal,this.owner.controls.animationStateMachine.setTrigger("land"),!1},onNoCollision:function(){this.owner.changeState("flying")}}},rightChestMapCollider:{kind:n(10),args:{tags:["level01"],checkPoint:[60,10]}},leftChestMapCollider:{kind:n(10),args:{tags:["level01"],checkPoint:[56,10]}},velocity:{kind:n(21)},loseChecker:{kind:n(33),args:{condition:function(){return this.owner.controls.transform.getBounds()[3]>=800},result:function(){this.owner.changeState("dying")}}},cameraFollow:{kind:n(32)}}};return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i))}return i(e,t),e}(s);t.exports=c},function(t,e,n){"use strict";var r=n(3),o=new r({update:function(){this.controls.advance.update(),this.controls.gravity.update(),this.controls.velocity.update(),this.controls.loseChecker.update(),this.controls.animationStateMachine.update(),this.controls.tailManager.update(),this.controls.bodySprite.update(),this.controls.tailSprite.update(),this.controls.cameraFollow.update()},message:function(t,e){switch(t){case"keyDown":this.controls.flap.startJump();break;case"walkRight":this.controls.advance.change(1);break;case"walkLeft":this.controls.advance.change(-1);break;case"stop":this.controls.advance.change(0)}}});t.exports=o},function(t,e,n){"use strict";function r(t){d.message("keyDown")}function o(t){d.message("keyUp")}function i(t){d.message("walkLeft")}function s(t){d.message("walkRight")}function a(t){d.message("stop")}function c(t){d.message("stop")}function u(t){if(!v)for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].pageX>window.innerWidth/2){r(t),v=!0;break}}function l(t){if(v)for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].pageX>window.innerWidth/2){o(t),v=!1;break}}function h(t){for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].pageX<window.innerWidth/2){b=t.changedTouches[e].pageX;break}}function p(t){for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].pageX<window.innerWidth/2){t.changedTouches[e].pageX<b?i(t):s(t),b=t.changedTouches[e].pageX;break}}function f(t){for(var e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].pageX<window.innerWidth/2){a(t);break}}var d,y=(n(3),n(12)),g=(n(9),n(11),n(2),n(4)),m=(n(0),n(20),n(13),n(63),n(28),n(27),new y({name:"Level01",assets:{bodySprites:"./assets/body-sprites.png",tailSprites:"./assets/tail-sprites.png",protoSprites:"./assets/proto-sprites.png",groundSpritesheet:"./assets/ground.png",background:"./assets/bg3.png",blop:"./assets/blop.wav",screech:"./assets/pusou.wav",groundTile:"./assets/ground-tile.png",groundAtlas:"./assets/sand-terrain.png"},tileMapSrc:"./assets/level01.png",tileMapKey:n(56),enter:function(){var t=this;y.prototype.enter.call(this).then(function(){g.addKeyDownListener(32,r),g.addKeyUpListener(32,o),g.addKeyDownListener(37,i),g.addKeyUpListener(37,a),g.addKeyDownListener(39,s),g.addKeyUpListener(39,c),document.addEventListener("touchstart",u),document.addEventListener("touchend",l),document.addEventListener("touchstart",h),document.addEventListener("touchmove",p),document.addEventListener("touchend",f),d=t.getObjectByName("player")})},exit:function(){g.removeKeyDownListener(32,r),g.removeKeyUpListener(32,o),g.removeKeyDownListener(37,i),g.removeKeyUpListener(37,a),g.removeKeyDownListener(39,s),g.removeKeyUpListener(39,c),document.removeEventListener("touchstart",u),document.removeEventListener("touchend",l),document.removeEventListener("touchstart",h),document.removeEventListener("touchmove",p),document.removeEventListener("touchend",f)},objects:[n(27),n(58),n(57)]})),v=!1,b=0;t.exports=m},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(7),c=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.owner=t.owner,n.parameters=t.parameters||{},n}return i(e,t),s(e,[{key:"evaluateChange",value:function(t,e){this.currentState.evaluateChange.call(this,t,e)}},{key:"getGame",value:function(){return this.owner.scene.game}},{key:"init",value:function(){}},{key:"setParameter",value:function(t,e){this.parameters[t]=e,this.evaluateChange(t,e)}},{key:"setTrigger",value:function(t,e){this.evaluateChange(t,e)}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(5),a=function(){function t(e){o(this,t),this.mapSrc=e.mapSrc,this.key=e.key,this.map=[],this.name=e.name||"tileMap"}return i(t,[{key:"init",value:function(){var t=this;return new Promise(function(e,n){var r=new Image;r.onload=function(){var n=document.createElement("canvas");n.width=r.width,n.height=r.height;var o=n.getContext("2d");o.drawImage(r,0,0,r.width,r.height);for(var i,a=o.getImageData(0,0,r.width,r.height).data,c=[],u=0;u<a.length;u+=4)i=parseInt(s([a[u],a[u+1],a[u+2]]).toHexString().$,16),c.push(i);t.map=[];for(var l=0;l<r.height;l++){t.map[l]=[];for(var h=0;h<r.width;h++)t.map[l].push(c[l*r.width+h])}e()},r.src=t.mapSrc})}},{key:"worldToMapCoords",value:function(t,e){return[Math.abs(Math.floor(t/32)),Math.abs(Math.floor(e/32))]}},{key:"getTileAtWorldPosition",value:function(t,e){var n=this.worldToMapCoords(t,e);this.getTileAtMapCoords.apply(this,r(n))}},{key:"getTileAtMapCoords",value:function(t,e){if(e>=this.map.length||t>=this.map[0].length)return null;var n=this.map[e][t];return 16777215==n?null:this.key[n]}},{key:"getSpriteAt",value:function(t,e){if(t>this.map.length-1||e>this.map[0].length-1)return null;var n=this.map[t][e];return 16777215==n?null:this.key[n]}},{key:"mapToWorldCoords",value:function(t,e){return[32*t,32*e]}}]),t}();t.exports=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=(n(2),function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="camera-follow",n.margin=t.margin||[50,100],n.shouldFollow=!1,n}return i(e,t),s(e,[{key:"update",value:function(){this.shouldFollow=!0}}]),e}(a));t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="lose-checker",n.condition=t.condition||function(){return!1},n.result=t.result||function(){},n}return i(e,t),s(e,[{key:"update",value:function(){this.condition()&&this.result()}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(5),u=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.floorNormal=[0,-1],n}return i(e,t),s(e,[{key:"startJump",value:function(){var t=c(this.floorNormal).timesScalar(7).$;this.owner.controls.velocity.y+=t[1],this.owner.changeState("flying"),this.owner.controls.animationStateMachine.setTrigger("flap"),this.owner.controls.tailManager.onGround=!1}},{key:"flap",value:function(){this.owner.controls.velocity.y-=Math.max(1.5,.9*this.owner.controls.velocity.y),this.owner.controls.animationStateMachine.setTrigger("flap")}},{key:"fall",value:function(){this.owner.controls.animationStateMachine.setTrigger("fall")}}]),e}(a);t.exports=u},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=function(t){function e(){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),s(e,[{key:"init",value:function(){this.sprites=this.owner.getControlsByName("sprite"),this.game=this.owner.getGame()}},{key:"makeVisible",value:function(){for(var t=0;t<this.sprites.length;t++)this.sprites[t].enabled=!0}},{key:"makeInvisible",value:function(){for(var t=0;t<this.sprites.length;t++)this.sprites[t].enabled=!1}},{key:"update",value:function(){Math.floor(1e3*this.game.dt)%2==0?this.makeInvisible():this.makeVisible()}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s,a,c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(0),l=n(2),h=n(1),p=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="infinitePlane",n.tag="renderer",n.layer=t.layer,n.rate=t.rate,n.spritesheetData=t.spritesheetData,n.offset=t.offset||[0,0],n.enabled=!0,s=h.getPixelWidth(),a=h.getPixelHeight(),n}return i(e,t),c(e,[{key:"render",value:function(){var t=h.getOffset(),e=Math.round(-t[0]%(s*this.rate)/this.rate),n=Math.round(-t[1]%(a*this.rate)/this.rate+this.offset[1]),r=Math.min(s-e,s);l.drawImage(this.owner.scene.assetManager.assets[this.spritesheetData.sheet],e,n,r,a,-t[0],-t[1],r,a);var o=s-r;o>0&&l.drawImage(this.owner.scene.assetManager.assets[this.spritesheetData.sheet],0,n,o,a,-t[0]+r,-t[1],o,a)}}]),e}(u);t.exports=p},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),u=(n(2),n(1),n(5)),l=n(24),h=function(t){function e(t){o(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="mapCollisionEngine",n.tileMap=t.tileMap,n.tag="physics",n.order=1,n.components=[],n}return s(e,t),a(e,[{key:"init",value:function(){this.tileMap=this.owner.scene.tileMap,this.components=this.owner.scene.getControlsByName("mapCollider")}},{key:"calculate",value:function(){for(var t=0;t<this.components.length;t++)if(this.components[t].enabled){for(var e=this.components[t],n=!1,o=!0,i=e.getWorldCheckPoint(),s=0;o;){var a,c;if(o=!1,s++>5){console.error("Stuck in collision loop");break}for(var h,p=e.getNextWorldCheckPoint(),f=[Math.min(i[0],p[0])-1,Math.min(i[1],p[1])-1],d=[Math.max(i[0],p[0])+1,Math.max(i[1],p[1])+1],y=(a=this.tileMap).worldToMapCoords.apply(a,f),g=(c=this.tileMap).worldToMapCoords.apply(c,d),m=[],v=y[0];v<=g[0];v++)for(var b=y[1];b<=g[1];b++)if(h=this.tileMap.getTileAtMapCoords(v,b))for(var w,k=0;k<h.rays.length;k++)w={ray:u(h.rays[k].ray).plusVector([32*v,32*b,32*v,32*b]).$,normal:h.rays[k].normal},m.push(w);if(0==m.length)break;m=m.sort(function(t,e){return u(i).sqDistanceToLineSegment(t.ray).$-u(i).sqDistanceToLineSegment(e.ray).$});for(var S,O,j=0;j<m.length;j++)if(S=m[j].ray,O=m[j].normal,u(p).isRightOf(S).$&&!u(i).isRightOf(S).$){if(n=!0,e.onHit(m[j]))break;var M=[].concat(r(p),r(u(p).plusVector(u(O).timesScalar(1e3).$).$)),x=l.lines.apply(l,r(M).concat(r(S))),_=u([].concat(r(p),r(x))).coordPairToVector().$,P=u(_).length().$;_=u(O).timesScalar(P+.1).$,e.owner.controls.velocity.y+=_[1],e.owner.controls.velocity.x+=_[0],o=!0;break}}n||e.onNoCollision()}}}]),e}(c);t.exports=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s,a,c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(0),l=n(2),h=n(1),p=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="mapRenderer",n.tag="renderer",n.layer=t.layer,n.tileMap,n.enabled=!0,s=Math.floor(h.getPixelWidth()/32)+32,a=Math.floor(h.getPixelHeight()/32)+32,n}return i(e,t),c(e,[{key:"init",value:function(){this.tileMap=this.owner.scene.tileMap}},{key:"render",value:function(){for(var t,e=h.getViewportPosition(),n=e[0]-e[0]%32-32,r=e[1]-e[1]%32-32,o=this.tileMap.worldToMapCoords(n,r),i=o[0],c=n;i<o[0]+a;i++,c+=32)for(var u=o[1],p=r;u<o[1]+s;u++,p+=32)(t=this.tileMap.getTileAtMapCoords(i,u))&&l.drawImage(this.owner.scene.assetManager.assets[t.sheet],t.coords.x,t.coords.y,32,32,c,p,32,32)}}]),e}(u);t.exports=p},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=(n(5),n(24),function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.tag="physics",n.order=0,n.components=[],n.playerCollider=void 0,n}return i(e,t),s(e,[{key:"init",value:function(){var t;t=this.owner.scene.getControlsByName("objectCollider");var e=t.findIndex(function(t){return"player"==t.owner.name});this.playerCollider=t[e],t.splice(e,1),this.components=t}},{key:"isColliding",value:function(t,e){return!(t[3]<e[1])&&(!(t[1]>e[3])&&(!(t[2]<e[0])&&!(t[0]>e[2])))}},{key:"calculate",value:function(){if(this.playerCollider.enabled)for(var t,e,n=0;n<this.components.length;n++)this.components[n].enabled&&(t=this.playerCollider.getWorldHitbox(),e=this.components[n].getWorldHitbox(),this.isColliding(t,e)&&(this.playerCollider.onHit(this.components[n]),this.components[n].onHit(this.playerCollider)))}}]),e}(a));t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=(n(2),n(1),function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="physicsEngine",n.engines=[],n.components=[],n}return i(e,t),s(e,[{key:"init",value:function(){this.engines=this.owner.scene.getControlsByTag("physics").sort(function(t,e){return t.order-e.order}),this.components=this.owner.scene.getControlsByName("velocity")}},{key:"update",value:function(){for(var t=0;t<this.engines.length;t++)this.engines[t].calculate();for(t=0;t<this.components.length;t++)this.components[t].applyVelocity()}}]),e}(a));t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=n(2),u=n(1),l=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name="renderingEngine",n.components=[],n.debugDrawLinesComponents=[],c.strokeStyle="green",n}return i(e,t),s(e,[{key:"init",value:function(){this.components=this.owner.scene.getControlsByTag("renderer").sort(function(t,e){return t.layer-e.layer}),this.debugDrawLinesComponents=this.owner.scene.getAllControls().filter(function(t){return void 0!=t.debugDrawLines})}},{key:"enableLayer",value:function(t,e){this.components[t].enabled=e}},{key:"update",value:function(){c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,320,240),c.setTransform(1,0,0,1,u.getOffset()[0],u.getOffset()[1]);for(var t=0;t<this.components.length;t++)this.components[t].enabled&&this.components[t].render();var e;for(t=0;t<this.debugDrawLinesComponents.length;t++)for(var n=0;n<this.debugDrawLinesComponents[t].debugDrawLines.length;n++)e=this.debugDrawLinesComponents[t].debugDrawLines[n],c.strokeStyle=n%2==0?"red":"green",c.beginPath(),c.moveTo(e[0],e[1]),c.lineTo(e[2],e[3]),c.stroke()}}]),e}(a);t.exports=l},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),c=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.oscillating=!1,n.oscillationMagnitude=0,n.progress=0,n.onGround=!1,n.blendAnimationLength=0,n.normalizationNum=0,n.tailPos=0,n.lastYPos=0,n.oscillationRate=100,n}return i(e,t),s(e,[{key:"init",value:function(){this.blendAnimationLength=this.owner.controls.tailSprite.currentAnimation.length,this.normalizationNum=Math.ceil(this.blendAnimationLength/2)}},{key:"changeDirection",value:function(t){0!=t&&this.owner.controls.tailSprite.setAnimation(1==t?"Rblend":"Lblend")}},{key:"oscillate",value:function(){this.progress+=this.getGame().dt/this.oscillationRate,this.tailPos=Math.cos(this.progress)*this.oscillationMagnitude,this.oscillationMagnitude-=this.getGame().dt/150,this.oscillationMagnitude=Math.max(this.oscillationMagnitude,0)}},{key:"startOscillation",value:function(t){this.oscillationMagnitude=t,this.progress=0}},{key:"tweenTowards",value:function(t){var e=t-this.tailPos;Math.abs(e)<.5?this.tailPos=this.owner.controls.velocity.y:this.tailPos+=.5*Math.sign(e)}},{key:"offsetTowardsButtPosition",value:function(){"Lwalk"!=this.owner.controls.bodySprite.currentAnimationName&&"Rwalk"!=this.owner.controls.bodySprite.currentAnimationName||1!=this.owner.controls.bodySprite.currentFrameNum?this.owner.controls.tailSprite.offset[1]=0:this.owner.controls.tailSprite.offset[1]=-1}},{key:"update",value:function(){this.offsetTowardsButtPosition();var t=this.owner.controls.transform.position[1],e=t-this.lastYPos;Math.abs(e)>=1?(this.oscillating=!1,this.tweenTowards(e)):this.oscillating?(0!=this.owner.controls.velocity.x&&(this.oscillationMagnitude=Math.max(this.oscillationMagnitude,1)),this.oscillate()):(this.oscillating=!0,this.startOscillation(this.tailPos)),this.owner.controls.tailSprite.setFrame(this.blendAnimationLength-Math.floor(this.tailPos/2+this.normalizationNum)),this.lastYPos=t}}]),e}(a);t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=(n(2),n(1),n(4),n(3),n(7),function t(e){r(this,t),this.name="debugManager",this.game=e.game,this.clipboard=[],this.canvasManagers={scene:new(n(45))({game:this.game,canvas:document.getElementById("canvas"),clipboard:this.clipboard}),inspector:new(n(44))({game:this.game,canvas:document.getElementById("inspector-canvas"),clipboard:this.clipboard})},this.canvasManagers.inspector.changeState("initial")});t.exports=o},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=(n(1),n(4),n(3),n(7)),u=function(t){function e(t){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{name:"sceneViewManager",states:{initial:n(47),multipleSelection:n(48),scroll:n(23),off:n(22)},initialState:"off"}));return r.canvas=t.canvas,r.renderer=r.canvas.getContext("2d"),r.clipboard=t.clipboard,r.game=t.game,r.buttons={atlasSelect:document.getElementById("atlas-select"),drawAtlasGrid:document.getElementById("inspector-show-grid"),copy:document.getElementById("copy-button")},r.keys={space:32,shift:16},r.updateLoop,r.shouldShowGrid=!0,r.shouldSnapToGrid=!1,r.highlightedObject,r.highlightedTileCoords,r.highlightedTile,r.worldSelectionStart,r.worldSelectionEnd,r.mapSelectionStart,r.mapSelectionEnd,r.selectedTiles,r.selectionWidth,r.selectionHeight,r.objectDeltaX,r.objectDeltaY,r.lastMouseX,r.lastMouseY,r.currentMouseX,r.currentMouseY,r.mouseDown=!1,r.shiftDown=!1,r.pixelWidth,r.pixelHeight,r.gridCanvas=document.createElement("canvas"),r.gridCtx,r.gridWidth=320,r.gridHeight=240,r.atlasImage,r.atlasName,r.buttons.atlasSelect.onchange=function(t){r.atlasImage=new Image,r.atlasImage.onload=r.render.bind(r),r.atlasName=t.target.value,r.atlasImage.src="../assets/"+r.atlasName},r.buttons.drawAtlasGrid.onchange=function(t){r.shouldShowGrid=!r.shouldShowGrid,r.render()},r.buttons.copy.onclick=r.copy.bind(r),r.onMouseDown=r.onMouseDown.bind(r),r.onMouseMove=r.onMouseMove.bind(r),r.onMouseUp=r.onMouseUp.bind(r),r.onKeyDown=r.onKeyDown.bind(r),r.onKeyUp=r.onKeyUp.bind(r),r}return s(e,t),a(e,[{key:"onMouseDown",value:function(t){this.currentState.onMouseDown.call(this,t)}},{key:"onMouseMove",value:function(t){this.currentState.onMouseMove.call(this,t)}},{key:"onMouseUp",value:function(t){this.currentState.onMouseUp.call(this,t)}},{key:"onKeyDown",value:function(t){this.currentState.onKeyDown.call(this,t)}},{key:"onKeyUp",value:function(t){this.currentState.onKeyUp.call(this,t)}},{key:"advanceFrame",value:function(t){t.preventDefault(),this.game.advanceFrame()}},{key:"copy",value:function(t){var e=this.selectionWidth/32,n=this.selectionHeight/32;this.clipboard=[];for(var r=0;r<n;r++){this.clipboard[r]=[];for(var o=0;o<e;o++){var i={};i.image=this.atlasImage,i.coords=[this.worldSelectionStart[0]+32*o,this.worldSelectionStart[1]+32*r],this.clipboard[r][o]=i}}}},{key:"highlightObject",value:function(t){var e;this.renderer.beginPath(),(e=this.renderer).rect.apply(e,r(t.controls.transform.position).concat(r(t.controls.transform.size))),this.renderer.stroke()}},{key:"highlightTile",value:function(t){var e;this.renderer.beginPath(),(e=this.renderer).rect.apply(e,r(t)),this.renderer.stroke()}},{key:"highlightTiles",value:function(){var t;this.renderer.beginPath(),(t=this.renderer).rect.apply(t,r(this.worldSelectionStart).concat([this.selectionWidth,this.selectionHeight])),this.renderer.stroke()}},{key:"getPointerWorldspace",value:function(){return[this.currentMouseX/2,this.currentMouseY/2]}},{key:"render",value:function(){if(this.atlasImage){if(this.renderer.clearRect(0,0,320,240),this.renderer.drawImage(this.atlasImage,0,0),this.shouldShowGrid){this.renderer.drawImage(this.gridCanvas,0,0,this.gridWidth,this.gridHeight,0,0,this.gridWidth,this.gridHeight)}this.highlightedObject?this.highlightObject(this.highlightedObject):this.highlightedTileCoords&&this.highlightTile(this.highlightedTileCoords)}}},{key:"drawGridCanvas",value:function(t,e,n){t.strokeStyle="white";for(var r=0;r<=this.gridWidth;r+=32)t.beginPath(),t.moveTo(r,0),t.lineTo(r,this.gridWidth),t.stroke();for(var r=0;r<=this.gridHeight;r+=32)t.beginPath(),t.moveTo(0,r),t.lineTo(this.gridHeight,r),t.stroke()}}]),e}(c);t.exports=u},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(2),u=n(1),l=(n(4),n(3)),h=n(7),p=(function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}s(e,t),a(e,[{key:"onMouseUp",value:function(){}},{key:"onMouseDown",value:function(){}},{key:"onMouseMove",value:function(){}},{key:"onKeyDown",value:function(){}},{key:"onKeyUp",value:function(){}}])}(l),function(t){function e(t){o(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{name:"debugManager",states:{initial:n(46),selection:n(53),multipleSelection:n(52),scroll:n(23),moveObject:n(50),moveTile:n(51),moveMultipleTiles:n(49),off:n(22)},initialState:"off"}));return r.buttons={start:document.getElementById("start-button"),advanceFrame:document.getElementById("advance-frame"),scroll:document.getElementById("scroll-button"),sceneSelect:document.getElementById("scene-select"),showGrid:document.getElementById("show-grid"),snap:document.getElementById("snap"),layer1:document.getElementById("layer-1"),layer2:document.getElementById("layer-2"),layer3:document.getElementById("layer-3"),exportMap:document.getElementById("export-map"),undo:document.getElementById("undo"),paste:document.getElementById("paste")},r.keys={space:32,shift:16},r.updateLoop,r.renderer=c,r.clipboard=t.clipboard,r.shouldShowGrid=!1,r.shouldSnapToGrid=!1,r.highlightedObject,r.highlightedTileCoords,r.highlightedTile,r.worldSelectionStart,r.worldSelectionEnd,r.mapSelectionStart,r.mapSelectionEnd,r.selectedTiles,r.selectionWidth,r.selectionHeight,r.objectDeltaX,r.objectDeltaY,r.lastMouseX,r.lastMouseY,r.currentMouseX,r.currentMouseY,r.mouseDown=!1,r.shiftDown=!1,r.canvas=document.getElementById("canvas"),r.game,r.renderingEngine,r.player,r.objects,r.map,r.lastMap,r.pixelWidth,r.pixelHeight,r.gridCanvas=document.createElement("canvas"),r.gridCtx,r.gridWidth,r.gridHeight,r.inspectorCanvas=document.getElementById("inspector-canvas"),r.inspector=r.inspectorCanvas.getContext("2d"),r.atlasImage,r.inspectorGridCanvas=document.createElement("canvas"),r.inspectorGridCtx=r.inspectorGridCanvas.getContext("2d"),r.shouldDrawAtlasGrid=!0,r.game=t.game,r.buttons.start.onclick=function(t){t.preventDefault(),r.changeState("off"==r.currentStateName?"initial":"off")},r.buttons.scroll.onclick=function(t){t.preventDefault(),r.changeState("scroll"==r.currentStateName?"selection":"scroll")},r.buttons.showGrid.onchange=function(t){t.preventDefault(),r.shouldShowGrid=!r.shouldShowGrid},r.buttons.snap.onchange=function(t){t.preventDefault(),r.shouldSnapToGrid=!r.shouldSnapToGrid},r.buttons.advanceFrame.onclick=r.advanceFrame.bind(r),r.buttons.layer1.onchange=function(t){t.preventDefault(),r.renderingEngine.enableLayer(0,r.buttons.layer1.checked)},r.buttons.layer2.onchange=function(t){t.preventDefault(),r.renderingEngine.enableLayer(1,r.buttons.layer2.checked)},r.buttons.layer3.onchange=function(t){t.preventDefault(),r.renderingEngine.enableLayer(2,r.buttons.layer3.checked)},r.buttons.exportMap.onclick=function(t){t.preventDefault();var e=r.map.this.map.this.map(function(t){return t.join("")}).join("\n"),n=new Blob([e],{type:"text/plain;charset=utf-8;"}),o=window.document.createElement("a");o.href=window.URL.createObjectURL(n),o.download="this.map.txt",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n)},r.onMouseDown=r.onMouseDown.bind(r),r.onMouseMove=r.onMouseMove.bind(r),r.onMouseUp=r.onMouseUp.bind(r),r.onKeyDown=r.onKeyDown.bind(r),r.onKeyUp=r.onKeyUp.bind(r),r}return s(e,t),a(e,[{key:"onMouseDown",value:function(t){this.currentState.onMouseDown.call(this,t)}},{key:"onMouseMove",value:function(t){this.currentState.onMouseMove.call(this,t)}},{key:"onMouseUp",value:function(t){this.currentState.onMouseUp.call(this,t)}},{key:"onKeyDown",value:function(t){this.currentState.onKeyDown.call(this,t)}},{key:"onKeyUp",value:function(t){this.currentState.onKeyUp.call(this,t)}},{key:"advanceFrame",value:function(t){t.preventDefault(),this.game.advanceFrame()}},{key:"enableAllButtons",value:function(){for(var t in this.buttons)this.buttons[t].disabled=!1}},{key:"disableAllButtonsExcept",value:function(t){for(var e in this.buttons)this.buttons[e]!=t&&(this.buttons[e].disabled="disabled")}},{key:"selectScene",value:function(t){this.game.replaceTop(t.target.value),this.renderingEngine.update()}},{key:"highlightObject",value:function(t){var e;this.renderer.beginPath(),(e=this.renderer).rect.apply(e,r(t.controls.transform.position).concat(r(t.controls.transform.size))),this.renderer.stroke()}},{key:"highlightTile",value:function(t){var e;this.renderer.beginPath(),(e=this.renderer).rect.apply(e,r(t)),this.renderer.stroke()}},{key:"highlightTiles",value:function(){var t;this.renderer.beginPath(),(t=this.renderer).rect.apply(t,r(this.worldSelectionStart).concat([this.selectionWidth,this.selectionHeight])),this.renderer.stroke()}},{key:"getPointerWorldspace",value:function(){var t=u.getOffset();return[this.currentMouseX/2-t[0],this.currentMouseY/2-t[1]]}},{key:"render",value:function(){if(this.renderingEngine.update(),this.shouldShowGrid){var t=u.getOffset(),e=-t[0]+t[0]%32,n=-t[1]+t[1]%32;this.renderer.drawImage(this.gridCanvas,0,0,this.gridWidth,this.gridHeight,e,n,this.gridWidth,this.gridHeight)}this.highlightedObject?this.highlightObject(this.highlightedObject):this.highlightedTileCoords&&this.highlightTile(this.highlightedTileCoords)}},{key:"renderInspector",value:function(){this.inspector.clearRect(0,0,320,320),this.inspector.drawImage(this.atlasImage,0,0),this.shouldDrawAtlasGrid&&this.inspector.drawImage(this.inspectorGridCanvas,0,0)}},{key:"drawGridCanvas",value:function(t,e,n){t.strokeStyle="white";for(var r=0;r<=this.gridWidth;r+=32)t.beginPath(),t.moveTo(r,0),t.lineTo(r,this.gridWidth),t.stroke();for(var r=0;r<=this.gridHeight;r+=32)t.beginPath(),t.moveTo(0,r),t.lineTo(this.gridHeight,r),t.stroke()}}]),e}(h));t.exports=p},function(t,e,n){"use strict";var r=n(6),o=(n(2),n(1)),i=n(4),s=new r({enter:function(){this.game.stop(),i.turnOff(),this.buttons.start.innerHTML='<i class="fa fa-play"></i>',this.enableAllButtons(),this.game.debugMode=!0,this.camera=this.game.currentScene.getControlsByName("this.camera")[0],this.renderingEngine=this.game.currentScene.getControlsByName("renderingEngine")[0],this.player=this.game.currentScene.getObjectByName("this.player"),this.objects=this.game.currentScene.objects.filter(function(t){return!t.name.match(/background/)&&t.active&&t.controls.transform}),this.map=this.game.currentScene.getControlsByName("mapRenderer")[0].tileMap,this.pixelWidth=o.getPixelWidth(),this.pixelHeight=o.getPixelHeight(),this.gridWidth=this.pixelWidth+32,this.gridHeight=this.pixelWidth+32,this.gridCanvas.width=this.gridWidth,this.gridCanvas.height=this.gridHeight,this.gridCtx=this.gridCanvas.getContext("2d"),this.drawGridCanvas(this.gridCtx,this.gridCanvas.width,this.gridCanvas.height),this.canvas.addEventListener("mousedown",this.onMouseDown),this.canvas.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),this.render(),this.changeState("selection")}});t.exports=s},function(t,e,n){"use strict";var r=n(6),o=(n(2),n(1),n(4),new r({enter:function(){this.gridCanvas.width=this.gridWidth,this.gridCanvas.height=this.gridHeight,this.gridCtx=this.gridCanvas.getContext("2d"),this.drawGridCanvas(this.gridCtx,this.gridCanvas.width,this.gridCanvas.height),this.canvas.addEventListener("mousedown",this.onMouseDown),this.canvas.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.onKeyUp),this.changeState("multipleSelection")}}));t.exports=o},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=n(6),i=(n(1),n(4),new o({enter:function(t){this.worldSelectionStart=null,this.updateLoop=requestAnimationFrame(this.update.bind(this))},onMouseDown:function(t){if(!this.mouseDown){var e=this.getPointerWorldspace();this.worldSelectionStart=[e[0]-e[0]%32,e[1]-e[1]%32],this.worldSelectionEnd=[].concat(r(this.worldSelectionStart)),this.selectionWidth=32,this.selectionHeight=32,this.renderer.strokeStyle="red",this.highlightedTile=null,this.highlightedTileCoords=null,this.mouseDown=!0}},onMouseUp:function(t){this.mouseDown=!1},onMouseMove:function(t){if(this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY,this.mouseDown){var e=this.getPointerWorldspace();this.worldSelectionEnd=[e[0]+(32-e[0]%32),e[1]+(32-e[1]%32)],this.selectionWidth=this.worldSelectionEnd[0]-this.worldSelectionStart[0],this.selectionHeight=this.worldSelectionEnd[1]-this.worldSelectionStart[1]}},update:function(){this.updateLoop=requestAnimationFrame(this.update.bind(this)),this.render(),this.worldSelectionStart&&this.highlightTiles()}}));t.exports=i},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=n(6),i=n(2),s=(n(1),n(4),new o({enter:function(){i.strokeStyle="green",this.selectionWidth=this.worldSelectionEnd[0]-this.worldSelectionStart[0],this.selectionHeight=this.worldSelectionEnd[1]-this.worldSelectionStart[1];var t=this.mapSelectionStart[0],e=this.mapSelectionEnd[0],n=this.mapSelectionStart[1],r=this.mapSelectionEnd[1];this.selectedTiles=[];for(var o=t;o<=e;o++){for(var s=[],a=n;a<=r;a++)s.push(this.map.map[o][a]),this.map.map[o][a]=" ";this.selectedTiles.push(s)}},exit:function(){for(var t,e=(t=this.map).worldToMapCoords.apply(t,r(this.worldSelectionStart)),n=0;n<this.selectedTiles.length;n++)for(var o=0;o<this.selectedTiles[n].length;o++)this.map.map[e[0]+n][e[1]+o]=this.selectedTiles[n][o]},onMouseDown:function(t){var e=this.getPointerWorldspace();if(e[0]<this.worldSelectionStart[0]||e[0]>this.worldSelectionEnd[0]||e[1]<this.worldSelectionStart[1]||e[1]>this.worldSelectionEnd[1])return void this.changeState("selection");this.objectDeltaX=this.worldSelectionStart[0]-e[0],this.objectDeltaY=this.worldSelectionStart[1]-e[1],this.mouseDown=!0},onMouseMove:function(t){this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY},onMouseUp:function(t){this.mouseDown=!1},update:function(){if(this.updateLoop=requestAnimationFrame(this.update.bind(this)),this.mouseDown){var t=this.getPointerWorldspace(),e=t[0]+this.objectDeltaX,n=t[1]+this.objectDeltaY,r=e%32,o=n%32;r<=16?e-=r:e+=32-r,o<=16?n-=o:n+=32-o;var s=e-this.worldSelectionStart[0],a=e-this.worldSelectionStart[1];this.worldSelectionStart[0]=e,this.worldSelectionStart[1]=n,this.worldSelectionEnd[0]+=s,this.worldSelectionEnd[1]+=a,this.render();for(var c=0;c<this.selectedTiles.length;c++)for(var u=0;u<this.selectedTiles[c].length;u++)i.drawImage(this.game.currentScene.assetManager.assets[this.map.key[this.selectedTiles[c][u]].sheet],this.map.key[this.selectedTiles[c][u]].coords.x,this.map.key[this.selectedTiles[c][u]].coords.y,this.map.key[this.selectedTiles[c][u]].coords.w,this.map.key[this.selectedTiles[c][u]].coords.h,this.worldSelectionStart[0]+32*u,this.worldSelectionStart[1]+32*c,this.map.key[this.selectedTiles[c][u]].coords.w,this.map.key[this.selectedTiles[c][u]].coords.h);this.highlightTiles()}}}));t.exports=s},function(t,e,n){"use strict";var r=n(6),o=n(2),i=(n(1),n(4),new r({enter:function(){o.strokeStyle="red";var t=this.getPointerWorldspace();this.objectDeltaX=this.highlightedObject.controls.transform.position[0]-t[0],this.objectDeltaY=this.highlightedObject.controls.transform.position[1]-t[1]},onMouseMove:function(t){this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY},onMouseUp:function(t){this.changeState("selection")},update:function(){if(this.updateLoop=requestAnimationFrame(this.update.bind(this)),this.currentMouseX!=this.lastMouseX||this.currentMouseY!=this.lastMouseY){var t=this.getPointerWorldspace(),e=t[0]+this.objectDeltaX,n=t[1]+this.objectDeltaY;if(this.shouldSnapToGrid){var r=e%32,o=n%32;r<5?e-=r:r>27&&(e+=32-r),o<5?n-=o:o>27&&(n+=32-o)}this.highlightedObject.controls.transform.position[0]=e,this.highlightedObject.controls.transform.position[1]=n,this.render()}}}));t.exports=i},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=n(6),i=n(2),s=(n(1),n(4),new o({enter:function(){var t;i.strokeStyle="red";var e=this.getPointerWorldspace();this.objectDeltaX=this.highlightedTileCoords[0]-e[0],this.objectDeltaY=this.highlightedTileCoords[1]-e[1];var n=(t=this.map).worldToMapCoords.apply(t,r(e));this.map.map[n[0]][n[1]]=" "},exit:function(){var t=this.map.worldToMapCoords(this.highlightedTileCoords[0],this.highlightedTileCoords[1]);this.map.map[t[0]][t[1]]=this.highlightedTile},onMouseMove:function(t){this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY},onMouseUp:function(t){this.changeState("selection")},update:function(){this.updateLoop=requestAnimationFrame(this.update.bind(this));var t=this.getPointerWorldspace(),e=t[0]+this.objectDeltaX,n=t[1]+this.objectDeltaY,r=e%32,o=n%32;r<=16?e-=r:e+=32-r,o<=16?n-=o:n+=32-o,this.highlightedTileCoords[0]=e,this.highlightedTileCoords[1]=n,this.render(),i.drawImage(this.game.currentScene.assetManager.assets[this.map.key[this.highlightedTile].sheet],this.map.key[this.highlightedTile].coords.x,this.map.key[this.highlightedTile].coords.y,this.map.key[this.highlightedTile].coords.w,this.map.key[this.highlightedTile].coords.h,this.highlightedTileCoords[0],this.highlightedTileCoords[1],this.map.key[this.highlightedTile].coords.w,this.map.key[this.highlightedTile].coords.h)}}));t.exports=s},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=n(6),i=n(2),s=(n(1),n(4),new o({enter:function(t){this.worldSelectionStart=null},onMouseDown:function(t){var e;if(!this.mouseDown){var n=this.getPointerWorldspace();this.worldSelectionStart=[n[0]-n[0]%32,n[1]-n[1]%32],this.mapSelectionStart=(e=this.map).worldToMapCoords.apply(e,r(n)),this.worldSelectionEnd=[].concat(r(this.worldSelectionStart)),this.mapSelectionEnd=[].concat(r(this.mapSelectionStart)),this.selectionWidth=32,this.selectionHeight=32,i.strokeStyle="red",this.highlightedTile=null,this.highlightedTileCoords=null,this.mouseDown=!0}},onMouseUp:function(t){this.mouseDown=!1},onMouseMove:function(t){if(this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY,this.mouseDown){var e,n=this.getPointerWorldspace();this.worldSelectionEnd=[n[0]+(32-n[0]%32),n[1]+(32-n[1]%32)],this.mapSelectionEnd=(e=this.map).worldToMapCoords.apply(e,r(n)),this.selectionWidth=this.worldSelectionEnd[0]-this.worldSelectionStart[0],this.selectionHeight=this.worldSelectionEnd[1]-this.worldSelectionStart[1]}},onKeyUp:function(t){t.keyCode==this.keys.shift&&(this.worldSelectionStart?this.changeState("moveMultipleTiles"):this.changeState("selection"))},update:function(){this.updateLoop=requestAnimationFrame(this.update.bind(this)),this.render(),this.worldSelectionStart&&this.highlightTiles()}}));t.exports=s},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=n(6),i=n(2),s=(n(1),n(4),new o({enter:function(){this.enableAllButtons(),i.strokeStyle="green",this.updateLoop=requestAnimationFrame(this.update.bind(this))},onMouseDown:function(t){this.highlightedObject?this.changeState("moveObject"):this.highlightedTileCoords&&this.changeState("moveTile")},onMouseMove:function(t){this.lastMouseX=this.currentMouseX,this.lastMouseY=this.currentMouseY,this.currentMouseX=t.layerX,this.currentMouseY=t.layerY},onKeyDown:function(t){t.keyCode==this.keys.space?this.changeState("scroll"):t.keyCode==this.keys.shift&&this.changeState("multipleSelection")},update:function(){if(this.updateLoop=requestAnimationFrame(this.update.bind(this)),this.currentMouseX!=this.lastMouseX||this.currentMouseY!=this.lastMouseY){var t,e=this.getPointerWorldspace();this.highlightedObject=null;for(var n=0;n<this.objects.length;n++)if(t=this.objects[n].controls.transform.getBounds(),e[0]>t[0]&&e[0]<t[2]&&e[1]>t[1]&&e[1]<t[3]){this.highlightedObject=this.objects[n],this.highlightObject(this.highlightedObject);break}if(!this.highlightedObject){var o,i=(o=this.map).worldToMapCoords.apply(o,r(e)),s=this.map.map[i[0]][i[1]];this.highlightedTile=s,this.highlightedTileCoords=[e[0]-e[0]%32,e[1]-e[1]%32,32,32]}this.render()}}}));t.exports=s},function(t,e,n){"use strict";var r=n(8),o=(n(12),n(14),n(29)),i=new r({scenes:{level01:o}});i.start(),i.push("level01"),t.exports={$:n(5)}},function(t,e,n){"use strict";var r={clamp:function(t,e,n){return Math.max(Math.min(t,n),e)}};t.exports=r},function(t,e,n){"use strict";function r(t,e,n,r){}var o={0:{sheet:"groundAtlas",coords:{x:32,y:32,w:32,h:32},rays:[],onHit:r},8325038:{sheet:"groundAtlas",coords:{x:32,y:0,w:32,h:32},rays:[{ray:[0,0,32,0],normal:[0,-1]}],onHit:r},16416927:{sheet:"groundAtlas",coords:{x:0,y:32,w:32,h:32},rays:[{ray:[0,32,0,0],normal:[-1,0]}],onHit:r},687282:{sheet:"groundAtlas",coords:{x:64,y:32,w:32,h:32},rays:[{ray:[32,0,32,32],normal:[1,0]}],onHit:r},11701498:{sheet:"groundAtlas",coords:{x:0,y:0,w:32,h:32},rays:[{ray:[0,0,32,0],normal:[0,-1]},{ray:[0,32,0,0],normal:[-1,0]}],onHit:r},10987514:{sheet:"groundAtlas",coords:{x:64,y:0,w:32,h:32},rays:[{ray:[0,0,32,0],normal:[0,-1]},{ray:[32,0,32,32],normal:[1,0]}],onHit:r},11604909:{sheet:"groundAtlas",coords:{x:160,y:128,w:32,h:32},rays:[{ray:[0,32,32,16],normal:[-.4472135954999579,-.8944271909999159]}],onHit:r},9047942:{sheet:"groundAtlas",coords:{x:192,y:128,w:32,h:32},rays:[{ray:[0,16,32,0],normal:[-.4472135954999579,-.8944271909999159]}],onHit:r},2960311:{sheet:"groundAtlas",coords:{x:32,y:128,w:32,h:32},rays:[{ray:[0,0,32,32],normal:[.7071067811865475,-.7071067811865475]}],onHit:r},16081320:{sheet:"groundAtlas",coords:{x:256,y:160,w:32,h:32},rays:[{ray:[0,32,16,0],normal:[-.8944271909999159,-.4472135954999579]}],onHit:r},16094659:{sheet:"groundAtlas",coords:{x:288,y:128,w:32,h:32},rays:[{ray:[16,32,32,0],normal:[-.8944271909999159,-.4472135954999579]}],onHit:r},5706164:{sheet:"groundAtlas",coords:{x:96,y:128,w:32,h:32},rays:[{ray:[0,0,32,16],normal:[.4472135954999579,-.8944271909999159]}],onHit:r},7295925:{sheet:"groundAtlas",coords:{x:128,y:128,w:32,h:32},rays:[{ray:[0,16,32,32],normal:[.4472135954999579,-.8944271909999159]}],onHit:r},1403350:{sheet:"groundAtlas",coords:{x:224,y:128,w:32,h:32},rays:[{ray:[0,0,16,32],normal:[.8944271909999159,-.4472135954999579]}],onHit:r},1136818:{sheet:"groundAtlas",coords:{x:224,y:160,w:32,h:32},rays:[{ray:[16,0,32,32],normal:[.8944271909999159,-.4472135954999579]}],onHit:r}};t.exports=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(9),a=n(3),c=function(t){function e(t){r(this,e);var i={name:"post-systems",scene:t.scene,states:{normal:new a({update:function(){this.controls.groundPool.update(),this.controls.physicsEngine.update(),this.controls.camera.update(),this.controls.renderingEngine.update()}})},initialState:"normal",controls:{background:{kind:n(36),args:{rate:7.5,spritesheetData:n(60),offset:[0,200],layer:0}},mapRenderer:{kind:n(38)},groundSpriteEngine:{kind:n(20),args:{layer:2}},renderingEngine:{kind:n(41)},physicsEngine:{kind:n(40)},groundLevelObstaclePool:{kind:n(19),args:{tag:"groundLevel"}},groundPool:{kind:n(19),args:{tag:"ground"}},objectCollisionEngine:{kind:n(39),args:{tag:"ground"}},mapCollisionEngine:{kind:n(37)},camera:{kind:n(1)}}};return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i))}return i(e,t),e}(s);t.exports=c},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(9),a=(n(8),n(5),function(t){function e(t){r(this,e);var i={name:"proto",scene:t.scene,active:!0,states:{walking:n(66)},initialState:"walking",controls:{transform:{kind:n(13),args:{position:[300,100],size:[80,44]}},advance:{kind:n(15),args:{acceleration:.5}},gravity:{kind:n(17)},animationStateMachine:{kind:n(16),args:{tag:"proto",states:n(69),initialState:"initial",parameters:{direction:0}}},sprite:{kind:n(11),args:{tag:"proto",spritesheetName:"protoSprites",spritesheetData:n(62),animations:{Lstand:["Lstand"],Lwalk:["Lwalk00","Lwalk01"],Rstand:["Rstand"],Rwalk:["Rwalk00","Rwalk01"]},initialAnimation:["Lstand",!0],layer:2}},feetMapCollider:{kind:n(10),args:{tags:["level01"],checkPoint:[40,44]}},objectCollider:{kind:n(18),args:{hitbox:[10,20,70,40]}},velocity:{kind:n(21)}}};return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i))}return i(e,t),e}(s));t.exports=a},function(t,e,n){"use strict";var r={canvasID:"canvas"};t.exports=r},function(t,e,n){"use strict";var r={sheet:"background",frames:{default:{x:0,y:0,w:320,h:720}}};t.exports=r},function(t,e,n){"use strict";var r={sheet:"bodySprites",frames:{Rraptorstand:{x:0,y:68,w:64,h:34},Rraptorflap00:{x:0,y:0,w:64,h:34},Rraptorflap01:{x:0,y:34,w:64,h:34},Rraptorwalk00:{x:0,y:102,w:64,h:34},Rraptorwalk01:{x:0,y:136,w:64,h:34},Lraptorstand:{x:64,y:68,w:64,h:34},Lraptorflap00:{x:64,y:0,w:64,h:34},Lraptorflap01:{x:64,y:34,w:64,h:34},Lraptorwalk00:{x:64,y:102,w:64,h:34},Lraptorwalk01:{x:64,y:136,w:64,h:34}}};t.exports=r},function(t,e,n){"use strict";var r={sheet:"protoSpritesheet",frames:{Lstand:{x:160,y:0,w:80,h:44},Lwalk00:{x:0,y:0,w:80,h:44},Lwalk01:{x:80,y:0,w:80,h:44},Rstand:{x:400,y:0,w:80,h:44},Rwalk00:{x:240,y:0,w:80,h:44},Rwalk01:{x:320,y:0,w:80,h:44}}};t.exports=r},function(t,e,n){"use strict";var r={sheet:"raptorSpritesheet",frames:{flap00:{x:1,y:1,w:48,h:34},flap01:{x:51,y:1,w:48,h:34},walk00:{x:101,y:1,w:48,h:34},walk01:{x:151,y:1,w:48,h:34},hurt:{x:201,y:1,w:48,h:34}}};t.exports=r},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o,i={sheet:"tailSprites",frames:(o={Rtail00:{x:0,y:0,w:64,h:34},Rtail01:{x:0,y:34,w:64,h:34},Rtail02:{x:0,y:68,w:64,h:34},Rtail03:{x:0,y:102,w:64,h:34},Rtail04:{x:0,y:136,w:64,h:34},Rtail05:{x:0,y:170,w:64,h:34},Rtail06:{x:0,y:204,w:64,h:34},Rtail07:{x:0,y:238,w:64,h:34},Rtail08:{x:0,y:272,w:64,h:34},Ltail00:{x:64,y:0,w:64,h:34},Ltail01:{x:64,y:34,w:64,h:34},Ltail02:{x:64,y:68,w:64,h:34},Ltail03:{x:64,y:102,w:64,h:34},Ltail04:{x:64,y:136,w:64,h:34},Ltail05:{x:64,y:170,w:64,h:34},Ltail06:{x:64,y:204,w:64,h:34},Ltail07:{x:64,y:238,w:64,h:34}},r(o,"Ltail07",{x:64,y:272,w:64,h:34}),r(o,"Ltail08",{x:64,y:272,w:64,h:34}),o)};t.exports=i},function(t,e,n){"use strict";function r(){o=requestAnimationFrame(r.bind(this)),this.controls.flicker.update.call(this.controls.flicker),this.controls.velocity.x=Math.min(Math.max(this.controls.velocity.x,-3),3)}var o,i=n(3),s=new i({enter:function(){this.scene.assetManager.play("screech"),this.controls.objectCollider.enabled=!1,o=requestAnimationFrame(r.bind(this)),setTimeout(function(){cancelAnimationFrame(o),this.controls.flicker.makeVisible(),this.controls.objectCollider.enabled=!0}.bind(this),1e3)},update:function(){this.controls.gravity.update(),this.controls.velocity.update(),this.controls.flicker.update(),this.controls.bodySprite.update(),this.controls.tailSprite.update(),this.controls.cameraFollow.update()}});t.exports=s},function(t,e,n){"use strict";var r=n(3),o=new r({enter:function(){},update:function(){var t=this.scene.getObjectByName("player").controls.transform.position[0]-this.controls.transform.position[0];Math.abs(t)<100?this.controls.advance.change(0):Math.abs(t)<200&&this.controls.advance.change(Math.sign(this.scene.getObjectByName("player").controls.transform.position[0]-this.controls.transform.position[0])),this.controls.advance.update(),this.controls.gravity.update(),this.controls.velocity.update(),this.controls.animationStateMachine.update(),this.controls.sprite.update()}});t.exports=o},function(t,e,n){"use strict";var r=n(3),o=new r({update:function(){this.controls.advance.update(),this.controls.gravity.update(),this.controls.velocity.update(),this.controls.loseChecker.update(),this.controls.animationStateMachine.update(),this.controls.tailManager.update(),this.controls.bodySprite.update(),this.controls.tailSprite.update(),this.controls.cameraFollow.update()},message:function(t,e){switch(t){case"keyDown":this.controls.flap.flap();break;case"keyUp":this.controls.flap.fall();break;case"walkRight":this.controls.advance.change(1);break;case"walkLeft":this.controls.advance.change(-1);break;case"stop":this.controls.advance.change(0)}}});t.exports=o},function(t,e,n){"use strict";var r=n(3),o=new r({update:function(){this.changeState("Rstand")},evaluateChange:function(){}}),i=new r({enter:function(){this.sprite.setAnimation("Lstand",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(-1==e?"Lwalk":"Rwalk"),this.owner.controls.tailManager.changeDirection(e);break;case"flap":this.changeState("Ljump")}}}),s=new r({enter:function(){this.sprite.setAnimation("Rstand",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(-1==e?"Lwalk":"Rwalk"),this.owner.controls.tailManager.changeDirection(e);break;case"flap":this.changeState("Rjump")}}}),a=new r({enter:function(){this.sprite.setAnimation("Lwalk",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(1==e?"Rwalk":"Lstand"),this.owner.controls.tailManager.changeDirection(e);break;case"flap":this.changeState("Ljump")}}}),c=new r({enter:function(){this.sprite.setAnimation("Rwalk",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(-1==e?"Lwalk":"Rstand"),this.owner.controls.tailManager.changeDirection(e);break;case"flap":this.changeState("Rjump")}}}),u=(new r({enter:function(){this.sprite.setAnimation("LwalkTailCurled",!0)}}),new r({enter:function(){this.sprite.setAnimation("RwalkTailCurled",!0)}}),new r({enter:function(){this.sprite.setAnimation("Ljump",!0)},evaluateChange:function(t,e){switch(t){case"direction":1==e&&(this.changeState("Rjump"),this.owner.controls.tailManager.changeDirection(e));break;case"fall":this.changeState("Lfall");break;case"land":this.changeState(0==this.parameters.direction?"Lstand":"Lwalk")}}})),l=new r({enter:function(){this.sprite.setAnimation("Rjump",!0)},evaluateChange:function(t,e){switch(t){case"direction":-1==e&&(this.changeState("Ljump"),this.owner.controls.tailManager.changeDirection(e));break;case"fall":this.changeState("Rfall");break;case"land":this.changeState(0==this.parameters.direction?"Rstand":"Rwalk")}}}),h=new r({enter:function(){this.sprite.setAnimation("Lfall",!0)},evaluateChange:function(t,e){switch(t){case"direction":1==e&&(this.changeState("Rfall"),this.owner.controls.tailManager.changeDirection(e));break;case"flap":this.changeState("Ljump");break;case"land":this.changeState(0==this.parameters.direction?"Lstand":"Lwalk")}}}),p=new r({enter:function(){this.sprite.setAnimation("Rfall",!0)},evaluateChange:function(t,e){switch(t){case"direction":-1==e&&(this.changeState("Lfall"),this.owner.controls.tailManager.changeDirection(e));break;case"flap":this.changeState("Rjump");break;case"land":this.changeState(0==this.parameters.direction?"Rstand":"Rwalk")}}}),f={initial:o,Rstand:s,Lstand:i,Rwalk:c,Lwalk:a,Rjump:l,Ljump:u,Rfall:p,Lfall:h};t.exports=f},function(t,e,n){"use strict";var r=n(3),o=new r({update:function(){this.changeState("Rstand")},evaluateChange:function(){}}),i=new r({enter:function(){this.sprite.setAnimation("Lstand",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(-1==e?"Lwalk":"Rwalk");break;case"flap":this.changeState("Ljump")}}}),s=new r({enter:function(){this.sprite.setAnimation("Rstand",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(-1==e?"Lwalk":"Rwalk");break;case"flap":this.changeState("Rjump")}}}),a=new r({enter:function(){this.sprite.setAnimation("Lwalk",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(1==e?"Rwalk":"Lstand");break;case"flap":this.changeState("Ljump")}}}),c=new r({enter:function(){this.sprite.setAnimation("Rwalk",!0)},evaluateChange:function(t,e){switch(t){case"direction":this.changeState(-1==e?"Lwalk":"Rstand");break;case"flap":this.changeState("Rjump")}}}),u=(new r({enter:function(){this.sprite.setAnimation("LwalkTailCurled",!0)}}),new r({enter:function(){this.sprite.setAnimation("RwalkTailCurled",!0)}}),new r({enter:function(){this.sprite.setAnimation("Ljump",!0)},evaluateChange:function(t,e){switch(t){case"direction":1==e&&this.changeState("Rjump");break;case"fall":this.changeState("Lfall");break;case"land":this.changeState(0==this.parameters.direction?"Lstand":"Lwalk")}}})),l=new r({enter:function(){this.sprite.setAnimation("Rjump",!0)},evaluateChange:function(t,e){switch(t){case"direction":-1==e&&this.changeState("Ljump");break;case"fall":this.changeState("Rfall");break;case"land":this.changeState(0==this.parameters.direction?"Rstand":"Rwalk")}}}),h=new r({enter:function(){this.sprite.setAnimation("Lfall",!0)},evaluateChange:function(t,e){switch(t){case"direction":1==e&&this.changeState("Rfall");break;case"flap":this.changeState("Ljump");break;case"land":this.changeState(0==this.parameters.direction?"Lstand":"Lwalk")}}}),p=new r({enter:function(){this.sprite.setAnimation("Rfall",!0)},evaluateChange:function(t,e){switch(t){case"direction":-1==e&&this.changeState("Lfall");break;case"flap":this.changeState("Rjump");break;case"land":this.changeState(0==this.parameters.direction?"Rstand":"Rwalk")}}}),f={initial:o,Rstand:s,Lstand:i,Rwalk:c,Lwalk:a,Rjump:l,Ljump:u,Rfall:p,Lfall:h};t.exports=f}]);